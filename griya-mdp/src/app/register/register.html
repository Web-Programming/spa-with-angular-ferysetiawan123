<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-7 col-lg-6">

      <div class="card shadow-lg border-0">
        <div class="card-body p-4 p-md-5">

          <!-- Success Alert -->
          <div class="alert alert-success alert-dismissible fade show" role="alert" *ngIf="successMessage">
            <i class="bi bi-check-circle-fill me-2"></i>{{ successMessage }}
            <button type="button" class="btn-close" (click)="successMessage = ''" aria-label="Close"></button>
          </div>

          <!-- Error Alert -->
          <div class="alert alert-danger alert-dismissible fade show" role="alert" *ngIf="errorMessage">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ errorMessage }}
            <button type="button" class="btn-close" (click)="errorMessage = ''" aria-label="Close"></button>
          </div>

          <!-- Form Register -->
          <form [formGroup]="registerForm" (ngSubmit)="submitRegister()">

            <!-- Name -->
            <div class="mb-4">
              <label class="form-label fw-semibold">
                <i class="bi bi-person-fill me-2"></i>Nama Lengkap
              </label>
              <input type="text" class="form-control form-control-lg"
                formControlName="name" placeholder="Masukkan nama Anda"
                [class.is-invalid]="registerForm.get('name')?.invalid && registerForm.get('name')?.touched">

              <div class="invalid-feedback d-block" *ngIf="registerForm.get('name')?.touched">
                <div *ngIf="registerForm.get('name')?.errors?.['required']">Nama harus diisi</div>
                <div *ngIf="registerForm.get('name')?.errors?.['minlength']">Nama minimal 2 karakter</div>
              </div>
            </div>

            <!-- Email -->
            <div class="mb-4">
              <label class="form-label fw-semibold">
                <i class="bi bi-envelope-fill me-2"></i>Email
              </label>
              <input type="email" class="form-control form-control-lg"
                formControlName="email" placeholder="nama@example.com"
                [class.is-invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">

              <div class="invalid-feedback d-block" *ngIf="registerForm.get('email')?.touched">
                <div *ngIf="registerForm.get('email')?.errors?.['required']">Email harus diisi</div>
                <div *ngIf="registerForm.get('email')?.errors?.['email']">Format email tidak valid</div>
              </div>
            </div>

            <!-- Password -->
            <div class="mb-4">
              <label class="form-label fw-semibold">
                <i class="bi bi-lock-fill me-2"></i>Password
              </label>

              <div class="input-group">
                <input [type]="showPassword ? 'text' : 'password'"
                  class="form-control form-control-lg"
                  formControlName="password" placeholder="Minimal 6 karakter"
                  [class.is-invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">

                <button type="button" class="btn btn-outline-secondary"
                  (click)="showPassword = !showPassword">
                  <i [ngClass]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
                </button>
              </div>

              <div class="invalid-feedback d-block" *ngIf="registerForm.get('password')?.touched">
                <div *ngIf="registerForm.get('password')?.errors?.['required']">Password harus diisi</div>
                <div *ngIf="registerForm.get('password')?.errors?.['minlength']">Password minimal 6 karakter</div>
              </div>

              <div class="form-text" *ngIf="registerForm.get('password')?.valid">
                Gunakan kombinasi huruf, angka, dan simbol
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="mb-4">
              <label class="form-label fw-semibold">
                <i class="bi bi-lock-fill me-2"></i>Konfirmasi Password
              </label>

              <div class="input-group">
                <input [type]="showConfirmPassword ? 'text' : 'password'"
                  class="form-control form-control-lg"
                  formControlName="confirmPassword"
                  placeholder="Ketik ulang password"
                  [class.is-invalid]="(registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched) || (registerForm.errors?.['mismatch'] && registerForm.get('confirmPassword')?.touched)">

                <button type="button" class="btn btn-outline-secondary"
                  (click)="showConfirmPassword = !showConfirmPassword">
                  <i [ngClass]="showConfirmPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
                </button>
              </div>

              <div class="invalid-feedback d-block" *ngIf="registerForm.get('confirmPassword')?.touched">
                <div *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">Konfirmasi password harus diisi</div>
              </div>

              <div class="invalid-feedback d-block"
                *ngIf="registerForm.errors?.['mismatch'] && registerForm.get('confirmPassword')?.touched">
                Password dan Konfirmasi Password tidak cocok
              </div>
            </div>

            <!-- Submit -->
            <div class="d-grid gap-2 mb-3">
              <button type="submit" class="btn btn-primary btn-lg py-3"
                [disabled]="registerForm.invalid || isLoading">

                <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
                <i *ngIf="!isLoading" class="bi bi-person-plus-fill me-2"></i>

                {{ isLoading ? 'Memproses...' : 'Daftar Sekarang' }}
              </button>
            </div>

            <!-- Link ke Login -->
            <div class="text-center">
              <span>Sudah punya akun?</span>
              <a routerLink="/login" class="fw-semibold text-primary text-decoration-none">Login</a>
            </div>

          </form>
        </div>
      </div>

    </div>
  </div>
</div>
